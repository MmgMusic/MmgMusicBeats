<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMGEAR - Start</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Styles généraux pour la page d'accueil */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #f0f2f5;
            color: #000;
            font-family: 'Atkinson Hyperlegible', sans-serif;
            font-weight: 700;
            cursor: url('assets/cursors/pointer.cur') 16 16, auto;
        }

        a, button {
             cursor: url('assets/cursors/link.cur') 16 16, pointer;
        }
        
        input[type="text"], textarea {
            cursor: url('assets/cursors/text.cur') 16 16, text;
        }

        /* Conteneur principal pour centrer les éléments */
        #intro-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            position: relative;
            transition: opacity 1s ease-in-out;
        }

        /* Bouton START */
        #start-btn {
            padding: 15px 40px;
            font-size: 2em;
            font-weight: bold;
            color: #000;
            background-color: transparent;
            border: 4px solid #000;
            transition: all 0.3s ease;
            z-index: 10;
            font-family: 'Atkinson Hyperlegible', sans-serif;
            font-weight: 700;
        }

        #start-btn:hover {
            background-color: #000;
            color: #f0f2f5;
        }

        /* Styles pour l'animation responsive */
        .main-logo {
            position: absolute;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 95vw; 
            max-width: 1200px;
            aspect-ratio: 1200 / 300;
            height: auto;
            min-height: auto;
            opacity: 0;
            pointer-events: none;
        }

        /* CORRECTION: Ajout d'une media query pour mieux gérer la hauteur sur mobile */
        @media (max-height: 450px) {
            .main-logo {
                width: auto;
                height: 90vh; /* Utilise la hauteur de la fenêtre */
            }
        }

        .logo-animation {
            pointer-events: none;
            overflow: visible;
            display: flex;
            flex-shrink: 0;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        .anime-logo {
            overflow: visible;
            position: relative;
            display: flex;
            width: 100%;
            height: 180px;
        }

        .anime-logo-signs {
            overflow: visible;
            display: flex;
            align-items: flex-end;
            position: relative;
            width: 100%;
            height: 512px;
            margin-top: -352px;
            justify-content: center;
            box-sizing: border-box;
            padding: 20px;
        }

        .logo-group {
            display: flex;
            align-items: flex-end;
        }
        
        .logo-group-mm { transform: translateX(-100vw); }
        .logo-group-gear { transform: translateX(100vw); }

        .logo-letter {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            overflow: visible;
            height: 100%;
        }

        .logo-letter.letter-m1 { margin-right: 10px; }
        .logo-letter.letter-m2 { margin-right: 7px; }
        .logo-letter.letter-g { margin-right: -5px; }
        .logo-letter.letter-e { margin-right: -11px; }
        .logo-letter.letter-a { margin-right: 2px; }
        .logo-letter.letter-r { margin-right: 0; }

        .bounced {
            transform-origin: 50% 100% 0px;
            transform: translateY(200px) scaleX(.55) scaleY(.8);
        }

        .logo-animation .bounce {
            overflow: visible;
            position: absolute;
            left: 0;
            bottom: 70px;
        }

        .logo-animation .dot {
            opacity: 0.001;
            position: absolute;
            z-index: 10;
            top: 0;
            left: 0;
            width: 50px;
            height: 50px;
            margin: -25px 0 0 -25px;
            background-color: currentColor;
            transform: translate3d(0,0,0);
        }

        .logo-animation .logo-letter svg {
            overflow: visible;
            fill: none;
            fill-rule: evenodd;
            width: 100%;
            height: auto;
        }

        .logo-animation .line {
            fill: currentColor;
            stroke: none;
            fill-rule: evenodd;
            stroke-linecap: square;
            stroke-width: 4px;
        }

        .logo-animation .fill {
            opacity: .001;
            stroke: currentColor;
            stroke-width: 4px;
        }
        
        .logo-letter.letter-g path.line {
            transition: fill 0.5s ease-in-out;
        }

        /* Fondu blanc pour la transition */
        #fade-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fff;
            opacity: 0;
            pointer-events: none;
            z-index: 9999;
            transition: opacity 2.5s ease-in;
        }
    </style>
</head>
<body>

    <!-- Conteneur principal -->
    <div id="intro-container">
        <!-- Bouton de démarrage -->
        <button id="start-btn">START</button>

        <!-- Structure de l'animation (initialement cachée) -->
        <div class="main-logo">
            <div class="logo-animation">
                <div class="anime-logo">
                    <div class="anime-logo-signs">
                        <div class="logo-group logo-group-mm">
                            <div class="logo-letter letter-m1">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 40.3 28.601 L 40.3 55.001 L 30.3 55.001 L 30.3 27.301 Q 30.3 22.501 27.95 18.551 Q 25.6 14.601 21.65 12.251 Q 17.7 9.901 12.8 9.901 L 10 9.901 L 10 55.001 L 0 55.001 L 0 0.001 L 12.8 0.001 Q 19.9 0.001 25.85 3.251 Q 31.8 6.501 35.5 11.901 Q 39.3 6.501 45.05 3.251 Q 50.8 0.001 57.7 0.001 L 70.5 0.001 L 70.5 55.001 L 60.5 55.001 L 60.5 9.901 L 57.7 9.901 Q 52.9 9.901 48.95 12.451 Q 45 15.001 42.65 19.201 Q 40.3 23.401 40.3 28.601 Z"/></svg>
                            </div>
                            <div class="logo-letter letter-m2">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 40.3 28.601 L 40.3 55.001 L 30.3 55.001 L 30.3 27.301 Q 30.3 22.501 27.95 18.551 Q 25.6 14.601 21.65 12.251 Q 17.7 9.901 12.8 9.901 L 10 9.901 L 10 55.001 L 0 55.001 L 0 0.001 L 12.8 0.001 Q 19.9 0.001 25.85 3.251 Q 31.8 6.501 35.5 11.901 Q 39.3 6.501 45.05 3.251 Q 50.8 0.001 57.7 0.001 L 70.5 0.001 L 70.5 55.001 L 60.5 55.001 L 60.5 9.901 L 57.7 9.901 Q 52.9 9.901 48.95 12.451 Q 45 15.001 42.65 19.201 Q 40.3 23.401 40.3 28.601 Z"/></svg>
                            </div>
                        </div>
                        <div class="logo-group logo-group-gear">
                            <div class="logo-letter letter-g">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 61.201 22.3 L 61.201 55.2 L 25.701 55.2 Q 18.001 55.2 12.201 51.5 Q 6.401 47.8 3.201 41.5 Q 0.001 35.2 0.001 27.5 Q 0.001 19.8 3.201 13.6 Q 6.401 7.4 12.201 3.7 Q 18.001 0 25.701 0 L 61.201 0 L 61.201 10.1 L 25.701 10.1 Q 20.901 10.1 17.401 12.45 Q 13.901 14.8 12.001 18.7 Q 10.101 22.6 10.101 27.5 Q 10.101 32.4 12.001 36.4 Q 13.901 40.4 17.401 42.75 Q 20.901 45.1 25.701 45.1 L 51.101 45.1 L 51.101 32.4 L 22.401 32.4 L 22.401 22.3 L 61.201 22.3 Z"/></svg>
                            </div>
                            <div class="logo-letter letter-e">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 57.4 45.1 L 57.4 55.2 L 0 55.2 L 0 0 L 57.4 0 L 57.4 10.1 L 10.1 10.1 L 10.1 45.1 L 57.4 45.1 Z M 51 22.3 L 51 32.4 L 14.8 32.4 L 14.8 22.3 L 51 22.3 Z"/></svg>
                            </div>
                            <div class="logo-letter letter-a">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 63.8 0 L 63.8 55.2 L 53.8 55.2 L 53.8 40.1 L 15.3 40.1 L 15.3 29.9 L 53.8 29.9 L 53.8 10.1 L 27.8 10.1 Q 22.9 10.1 18.9 12.5 Q 14.9 14.9 12.5 18.85 Q 10.1 22.8 10.1 27.7 L 10.1 55.2 L 0 55.2 L 0 27.7 Q 0 22 2.15 16.95 Q 4.3 11.9 8.15 8.1 Q 12 4.3 17.05 2.15 Q 22.1 0 27.8 0 L 63.8 0 Z"/></svg>
                            </div>
                            <div class="logo-letter letter-r">
                                <svg class="bounced" viewBox="0 0 70.5 55.2" xmlns="http://www.w3.org/2000/svg"><path class="line" d="M 48.5 39.301 L 64.7 55.001 L 51.1 55.001 L 35.5 40.101 L 15.2 40.101 L 15.2 30.201 L 42.9 30.201 Q 47.1 30.201 50.05 27.151 Q 53 24.101 53 20.001 Q 53 15.801 50.05 12.851 Q 47.1 9.901 42.9 9.901 L 10 9.901 L 10 55.001 L 0 55.001 L 0 0.001 L 42.9 0.001 Q 48.5 0.001 53 2.701 Q 57.5 5.401 60.2 9.951 Q 62.9 14.501 62.9 20.001 Q 62.9 24.501 61.05 28.451 Q 59.2 32.401 55.95 35.251 Q 52.7 38.101 48.5 39.301 Z"/></svg>
                            </div>
                        </div>
                        <div class="bounce">
                            <svg viewBox="0 0 1000 260" width="1000" height="260" fill="none"><path d="M750,240 C750,111.154418 728.971354,40 650.160048,40 C571.348741,40 550,127.460266 550,210"/></svg>
                            <div class="dot"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Son de l'introduction -->
    <audio id="intro-sound" src="assets/MMGEARIntroSFX.ogg" preload="auto"></audio>

    <!-- Overlay pour la transition -->
    <div id="fade-overlay"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startBtn = document.getElementById('start-btn');
            const introSound = document.getElementById('intro-sound');
            const mainLogo = document.querySelector('.main-logo');
            const fadeOverlay = document.getElementById('fade-overlay');

            function fitElementToParent(el, padding, exception) {
                let timeout = null;
                function resize() {
                    if (timeout) clearTimeout(timeout);
                    anime.set(el, {scale: 1});
                    if (exception) anime.set(exception, {scale: 1});
                    const pad = padding || 0;
                    const parentEl = el.parentNode;
                    const elOffsetWidth = el.offsetWidth - pad;
                    const parentOffsetWidth = parentEl.offsetWidth;
                    const ratio = parentOffsetWidth / elOffsetWidth;
                    const invertedRatio = elOffsetWidth / parentOffsetWidth;
                    timeout = setTimeout(() => {
                        anime.set(el, {scale: ratio});
                        if (exception) anime.set(exception, {scale: invertedRatio});
                    }, 10);
                }
                resize();
                window.addEventListener('resize', resize);
            }

            const logoAnimation = (() => {
                const logoAnimationEl = document.querySelector('.logo-animation');
                const bouncePath = anime.path('.bounce path');

                fitElementToParent(logoAnimationEl, 0, '.bounce svg');

                anime.set('.dot', { translateX: 750, translateY: -200 });

                const logoAnimationTL = anime.timeline({
                    autoplay: false,
                    easing: 'easeOutSine'
                });
                
                logoAnimationTL.add({
                    targets: '.bounced',
                    transformOrigin: ['50% 100% 0px', '50% 100% 0px'],
                    translateY: [
                        {value: [150, -160], duration: 190, endDelay: 20, easing: 'cubicBezier(0.225, 1, 0.915, 0.980)'},
                        {value: 4, duration: 120, easing: 'easeInQuad'},
                        {value: 0, duration: 120, easing: 'easeOutQuad'}
                    ],
                    scaleX: [
                        {value: [.25, .85], duration: 190, easing: 'easeOutQuad'},
                        {value: 1.08, duration: 120, delay: 85, easing: 'easeInOutSine'},
                        {value: 1, duration: 260, delay: 25, easing: 'easeOutQuad'}
                    ],
                    scaleY: [
                        {value: [.3, .8], duration: 120, easing: 'easeOutSine'},
                        {value: .35, duration: 120, delay: 180, easing: 'easeInOutSine'},
                        {value: .57, duration: 180, delay: 25, easing: 'easeOutQuad'},
                        {value: .5, duration: 190, delay: 15, easing: 'easeOutQuad'}
                    ],
                    delay: anime.stagger(80)
                }, 1000)
                .add({
                    targets: '.dot',
                    opacity: { value: 1, duration: 100 },
                    translateY: 250,
                    scaleY: [4, .7],
                    scaleX: { value: 1.3, delay: 100, duration: 200},
                    duration: 280,
                    easing: 'cubicBezier(0.350, 0.560, 0.305, 1)'
                }, '-=290')
                .add({
                    targets: ['.logo-group-mm', '.logo-group-gear'],
                    translateX: 0,
                    easing: 'easeOutElastic(1, .6)',
                    duration: 1000,
                }, '-=600')
                .add({
                    targets: '.dot',
                    translateX: bouncePath('x'),
                    translateY: bouncePath('y'),
                    rotate: {value: '1turn', duration: 790},
                    scaleX: { value: 1, duration: 50, easing: 'easeOutSine' },
                    scaleY: [
                        { value: [1, 1.5], duration: 50, easing: 'easeInSine' },
                        { value: 1, duration: 50, easing: 'easeOutExpo' }
                    ],
                    easing: 'cubicBezier(0, .74, 1, .255)',
                    duration: 800
                }, '-=1273')
                .add({
                    targets: '.dot',
                    scale: 1,
                    rotate: '1turn',
                    scaleY: {value: .5, delay: 0, duration: 150, delay: 230},
                    translateX: 550,
                    translateY: [
                        {value: 244, duration: 100},
                        {value: 204, duration: 200, delay: 130},
                        {value: 224, duration: 225, easing: 'easeOutQuad', delay: 25}
                    ],
                    duration: 200,
                    easing: 'easeOutSine'
                }, '-=474')
                .add({
                    targets: '.logo-letter',
                    translateY: [
                        {value: 40, duration: 150, easing: 'easeOutQuart'},
                        {value: 0, duration: 800, easing: 'easeOutElastic(1, .5)'}
                    ],
                    strokeDashoffset: [anime.setDashoffset, 0],
                    delay: anime.stagger(60, {from: 'center'})
                }, '-=670')
                .add({
                    targets: '.bounced',
                    scaleY: [
                        {value: .4, duration: 150, easing: 'easeOutQuart'},
                        {value: .5, duration: 800, easing: 'easeOutElastic(1, .5)'}
                    ],
                    delay: anime.stagger(60, {from: 'center'})
                }, '-=1090')
                .add({
                    targets: '.logo-text',
                    translateY: [
                        {value: 20, easing: 'easeOutQuad', duration: 100},
                        {value: 0, easing: 'easeOutElastic(1, .9)', duration: 450}
                    ],
                    opacity: {value: [0.001, 1], duration: 50},
                    duration: 500
                }, '-=970')
                .add({
                    targets: '.logo-letter.letter-g .line',
                    fill: { value: '#ff0000', easing: 'easeOutQuad', duration: 200 },
                }, '-=470')
                .add({
                    targets: '.dot',
                    opacity: { value: 0, duration: 500, easing: 'linear' }
                }, '-=470');

                logoAnimationTL.complete = () => {
                    fadeOverlay.style.opacity = '1';
                    setTimeout(() => {
                        sessionStorage.setItem('mmg-intro-completed', 'true');
                        window.location.href = 'mmg-music-contents.html';
                    }, 2500);
                };

                return logoAnimationTL;
            })();

            startBtn.addEventListener('click', () => {
                document.body.style.cursor = 'none';
                startBtn.style.display = 'none';
                mainLogo.style.opacity = '1';
                logoAnimation.play();
                setTimeout(() => {
                    introSound.play().catch(e => console.error("La lecture audio a été bloquée par le navigateur."));
                }, 1000);
            });
        });
    </script>
</body>
</html>
